{"version":3,"file":"main/dist/scripts/main.js","mappings":"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","sources":["webpack://craft-embedded-assets/./src/assets/main/src/scripts/Button.ts","webpack://craft-embedded-assets/./src/assets/main/src/scripts/EmbeddedAssets.ts","webpack://craft-embedded-assets/./src/assets/main/src/scripts/Emitter.ts","webpack://craft-embedded-assets/./src/assets/main/src/scripts/Form.ts","webpack://craft-embedded-assets/./src/assets/main/src/scripts/Modal.ts","webpack://craft-embedded-assets/./src/assets/main/src/scripts/Preview.ts","webpack://craft-embedded-assets/./src/assets/main/src/scripts/utilities.ts","webpack://craft-embedded-assets/external var \"jQuery\"","webpack://craft-embedded-assets/webpack/bootstrap","webpack://craft-embedded-assets/webpack/runtime/make namespace object","webpack://craft-embedded-assets/./src/assets/main/src/scripts/main.ts"],"sourcesContent":["import * as $ from 'jquery'\n\nexport default class Button {\n  public $element: JQuery | null\n\n  constructor (label: string) {\n    this.$element = $('<div class=\"embedded-assets_button btn\" data-icon=\"globe\"></div>')\n    this.setLabel(label)\n  }\n\n  public destroy (): void {\n    this.$element?.remove()\n    this.$element = null\n  }\n\n  public setLabel (label: string): void {\n    this.$element?.text(Craft.t('embeddedassets', label))\n  }\n\n  public show (): void {\n    this.$element?.show()\n  }\n\n  public hide (): void {\n    this.$element?.hide()\n  }\n\n  public setActive (flag: boolean = true): void {\n    this.$element?.toggleClass('active', flag)\n  }\n}\n","import Button from './Button'\nimport Emitter from './Emitter'\nimport Modal from './Modal'\n\nexport default class EmbeddedAssets extends Emitter {\n  public modal: Modal | null\n  public buttons: Button[]\n  private _replaceAssetId: string\n  private _currentGetActionTarget: Function\n  private _preventNonWhitelistedUploads?: boolean\n\n  constructor () {\n    super()\n\n    this._currentGetActionTarget = () => -1\n\n    this.modal = new Modal(() => this._getActionTarget())\n    this.buttons = []\n\n    this.modal.on('hide', () => this.buttons.forEach(b => b.setActive(false)))\n    this.modal.on('save', (e: Event) => this.trigger('save', e))\n  }\n\n  public get preventNonWhitelistedUploads (): boolean {\n    return this._preventNonWhitelistedUploads ?? false\n  }\n\n  public set preventNonWhitelistedUploads (prevent: boolean) {\n    // Don't allow it to be reset\n    if (typeof this._preventNonWhitelistedUploads === 'undefined') {\n      this._preventNonWhitelistedUploads = prevent\n    }\n  }\n\n  public destroy (): void {\n    if (this.modal !== null) {\n      this.modal.destroy()\n      this.modal = null\n\n      this.trigger('destroy')\n    }\n  }\n\n  public setReplaceAssetId (id: string): void {\n    this._replaceAssetId = id\n  }\n\n  public addButton (\n    button: Button,\n    orientations: string[] = ['bottom', 'top', 'left', 'right'],\n    getActionTarget: Function = () => {},\n    replace: boolean = false\n  ): void {\n    this.buttons.push(button)\n\n    button.$element?.on('click', () => {\n      if (this.modal !== null) {\n        this._currentGetActionTarget = getActionTarget\n\n        this.buttons.forEach((b) => b.setActive(b === button))\n        this.modal.show(button.$element as JQuery, { orientations }, replace)\n        this.modal.form?.setReplace(replace, this._replaceAssetId)\n      }\n    })\n\n    this.trigger('addButton', { button })\n  }\n\n  public removeButton (button: Button): void {\n    this.buttons = this.buttons.filter(b => b !== button)\n\n    this.trigger('removeButton', { button })\n  }\n\n  private _getActionTarget (): void {\n    return this._currentGetActionTarget()\n  }\n}\n","export default class Emitter {\n  private readonly _events: Map<string, Function[]>\n\n  constructor () {\n    this._events = new Map()\n  }\n\n  public on (type: string, callback: Function): void {\n    if (!this._events.has(type)) {\n      this._events.set(type, [])\n    }\n\n    this._events.get(type)?.push(callback)\n  }\n\n  public off (type: string, callback?: Function): void {\n    if (this._events.size > 0) {\n      if (typeof callback !== 'undefined' && this._events.has(type)) {\n        const newList = this._events.get(type)?.filter((fn) => fn !== callback) as Function[]\n\n        if (newList.length > 0) {\n          this._events.set(type, newList)\n        } else {\n          this._events.delete(type)\n        }\n      } else {\n        this._events.delete(type)\n      }\n    }\n  }\n\n  public trigger (type: string, event: Object = {}): void {\n    if (this._events.size > 0 && this._events.has(type)) {\n      event = Object.assign(event, { type })\n\n      this._events.get(type)?.forEach(fn => fn.call(this, event))\n    }\n  }\n}\n","import * as $ from 'jquery'\nimport Emitter from './Emitter'\nimport Preview from './Preview'\nimport { PreviewResizeEvent } from './events'\nimport { PreviewResponse } from './responses'\nimport { uniqueId, isUrl } from './utilities'\n\nexport default class Form extends Emitter {\n  public $body: JQuery | null\n  public $element: JQuery | null\n  public $input: JQuery | null\n  public preview: Preview\n  private _height: number\n  private _heightMonitor: number\n  private _replace: boolean\n  private _replaceAssetId: string\n  private _state: string = 'idle'\n  private _url: string = ''\n\n  constructor (private readonly _getActionTarget: Function = () => {}) {\n    super()\n\n    const inputId = uniqueId()\n    const bodyId = uniqueId()\n\n    const formAction = Craft.getActionUrl('embeddedassets/actions/save')\n\n    this.$element = $(`\n      <form class=\"embedded-assets_form\" action=\"${formAction}\" method=\"post\">\n        <div class=\"embedded-assets_form_field\">\n          <label for=\"${inputId}\">URL</label>\n          <input type=\"text\" placeholder=\"http://\" id=\"${inputId}\" name=\"url\" autocomplete=\"off\" spellcheck=\"false\">\n        </div>\n        <div id=\"${bodyId}\" class=\"embedded-assets_form_body\">\n          <div class=\"spinner\"></div>\n        </div>\n      </form>\n    `)\n\n    this.$input = this.$element.find(`#${inputId}`)\n    this.$body = this.$element.find(`#${bodyId}`)\n\n    this.preview = new Preview()\n    this.$body.prepend(this.preview.$element as JQuery)\n\n    this.preview.on('load', (e: any) => {\n      if (e.url === this._url && this._state === 'requesting') {\n        this.setState('requested')\n      }\n    })\n\n    this.preview.on('blacklisted', (e: any) => {\n      if (e.url === this._url && this._state === 'requesting') {\n        this.setState('blacklisted')\n      }\n    })\n\n    this.preview.on('timeout', (e: any) => {\n      if (e.url === this._url && this._state === 'requesting') {\n        Craft.cp.displayError(Craft.t('embeddedassets', 'Could not retrieve embed information.'))\n\n        this.setState('idle')\n      }\n    })\n\n    this.preview.on('resize', (e: PreviewResizeEvent) => this.$body?.css('height', `${e.height}px`))\n\n    this.$element.on('submit', (e) => {\n      e.preventDefault()\n\n      const isSameUrl = this._url === this.$input?.val()\n\n      if (this._state === 'idle' || (this._state !== 'saving' && !isSameUrl)) {\n        this.request()\n      } else if (this._state === 'requested' && isSameUrl) {\n        this.save()\n      }\n    })\n\n    this.$input.on('change blur', () => this.request())\n\n    this.$input.on('paste', (e: JQueryEventObject) => {\n      const clipboardData = (e.originalEvent as ClipboardEvent).clipboardData\n      const url = clipboardData?.getData('text')\n\n      this.request(url)\n    })\n\n    this._setupHeightMonitor()\n  }\n\n  public destroy (): void {\n    this.preview.destroy()\n\n    this.$element?.remove()\n    this.$element = null\n    this.$input = null\n    this.$body = null\n\n    window.cancelAnimationFrame(this._heightMonitor)\n\n    this.trigger('destroy')\n  }\n\n  public request (url = this.$input?.val() as string): void {\n    if (this._state !== 'saving' && this._url !== url) {\n      this._url = url\n\n      if (isUrl(url)) {\n        this.setState('requesting')\n        this.preview.request({ url })\n      } else {\n        this.setState('idle')\n      }\n    }\n  }\n\n  public focus (): void {\n    if (this.$input !== null) {\n      const $input = this.$input as JQuery<HTMLInputElement>\n      $input[0].select()\n      $input[0].focus()\n    }\n  }\n\n  public clear (): void {\n    this.$input?.val('')\n    this.trigger('clear')\n    this.setState('idle')\n  }\n\n  public setReplace (replace: boolean, id: string): void {\n    this._replace = replace\n    this._replaceAssetId = id\n  }\n\n  public save (url = this.$input?.val() as string, actionTarget = this._getActionTarget()): void {\n    const data = {\n      ...actionTarget,\n      url,\n      assetId: this._replaceAssetId\n    }\n\n    Craft.queue.push(async () => await new Promise((resolve, reject) => {\n      Craft.sendActionRequest('POST', `embeddedassets/actions/${(this._replace ? 'replace' : 'save')}`, { data })\n        .then((response: PreviewResponse) => {\n          if (this._state === 'saving' && typeof response.data?.success !== 'undefined') {\n            this.clear()\n            this.trigger('save', response.data.payload)\n            resolve(undefined)\n          } else {\n            if (typeof response.data?.error !== 'undefined') {\n              Craft.cp.displayError(response.data.error)\n            }\n\n            this.setState('requested')\n            reject(new Error(response.data?.error))\n          }\n        })\n        .catch(reject)\n    }))\n\n    this.setState('saving')\n  }\n\n  public setState (state: string): void {\n    this._state = state\n    this.$element?.attr('data-state', state)\n\n    switch (state) {\n      case 'idle':\n        this._url = ''\n        this.trigger('idle')\n        break\n      case 'requesting':\n        this.trigger('requesting')\n        break\n      case 'requested':\n        this.trigger('requested')\n        break\n      case 'blacklisted':\n        this.trigger('blacklisted')\n        break\n      case 'saving':\n        this.trigger('saving')\n        break\n    }\n  }\n\n  private _setupHeightMonitor (): void {\n    this._height = 0\n\n    const monitorHeight: () => void = () => {\n      const height = this.$element?.height() ?? 0\n\n      if (this._height !== height) {\n        this.trigger('resize', { prevHeight: this._height, height })\n        this._height = height\n      }\n\n      this._heightMonitor = window.requestAnimationFrame(monitorHeight)\n    }\n\n    monitorHeight()\n  }\n}\n","import * as $ from 'jquery'\nimport Emitter from './Emitter'\nimport Form from './Form'\nimport { uniqueId } from './utilities'\n\nexport default class Modal extends Emitter {\n  public $cancel: JQuery\n  public $footer: JQuery | null\n  public $save: JQuery\n  public $spinner: JQuery\n  public form: Form | null\n  public hud: GarnishHUD | null\n  private readonly _monitor: number\n\n  constructor (private readonly _getActionTarget: Function = () => {}) {\n    super()\n\n    this.form = null\n    this.hud = null\n  }\n\n  public create ($target: JQuery, settings = {}): void {\n    settings = Object.assign({\n      hudClass: 'hud embedded-assets_hud',\n      mainClass: 'embedded-assets_hud_main',\n      minBodyWidth: 400\n    }, settings)\n\n    const cancelId = uniqueId()\n    const saveId = uniqueId()\n    const spinnerId = uniqueId()\n    const cancelLabel = Craft.t('app', 'Cancel')\n    const saveLabel = Craft.t('app', 'Save')\n\n    this.$footer = $(`\n      <div class=\"hud-footer embedded-assets_hud_footer\">\n        <div class=\"buttons right\">\n          <div id=\"${cancelId}\" class=\"btn\">${cancelLabel}</div>\n          <div id=\"${saveId}\" class=\"btn submit\">${saveLabel}</div>\n          <div id=\"${spinnerId}\" class=\"spinner hidden\"></div>\n        </div>\n      </div>\n    `)\n\n    this.$cancel = this.$footer.find(`#${cancelId}`)\n    this.$save = this.$footer.find(`#${saveId}`)\n    this.$spinner = this.$footer.find(`#${spinnerId}`)\n\n    this.form = new Form(this._getActionTarget)\n    this.hud = new Garnish.HUD($target, this.form.$element?.add(this.$footer) as JQuery, settings)\n\n    this.trigger('create')\n\n    this.$save.on('click', (e) => this.$save.hasClass('disabled') && e.stopImmediatePropagation())\n\n    this.$cancel.on('click', () => this.form?.clear())\n    this.$save.on('click', () => this.form?.save())\n    this.form.on('submit', () => this.form?.save())\n\n    this.form.on('save', (e: any) => this.trigger('save', e))\n    this.hud.on('show', () => this.trigger('show'))\n    this.hud.on('hide', () => this.trigger('hide'))\n\n    this.form.on('clear', () => this.hide())\n    this.form.on('save', () => this.hide())\n    this.hud.on('show', () => this.form?.request())\n    this.hud.on('show', () => this.form?.focus())\n    this.hud.on('hide', () => this.form?.setState('idle'))\n\n    this.hideFooter()\n    this.form.on('idle', () => this.hideFooter())\n    this.form.on('requesting', () => this.hideFooter())\n    this.form.on('requested', () => this.showFooter())\n    this.form.on('blacklisted', () => this.hideFooter())\n\n    this.form.on('idle', () => this.setSaving(false))\n    this.form.on('requesting', () => this.setSaving(false))\n    this.form.on('requested', () => this.setSaving(false))\n    this.form.on('blacklisted', () => this.setSaving(false))\n    this.form.on('saving', () => this.setSaving())\n    this.form.on('resize', () => this.hud?.updateSizeAndPosition())\n  }\n\n  public destroy (): void {\n    if (this.$footer !== null) {\n      this.$footer.remove()\n      this.$footer = null\n    }\n\n    if (this.form !== null) {\n      this.form.destroy()\n      this.form = null\n    }\n\n    if (this.hud !== null) {\n      this.hud.hide()\n      this.hud.$hud.remove()\n      this.hud.$shade.remove()\n      this.hud = null\n    }\n\n    window.cancelAnimationFrame(this._monitor)\n\n    this.trigger('destroy')\n  }\n\n  public show ($target: JQuery, settings = {}, replace: any): void {\n    if (this.hud !== null) {\n      this.hud.setSettings(settings)\n      this.hud.$trigger = $($target)\n\n      if (this.hud.showing) {\n        this.hud.queueUpdateSizeAndPosition()\n      } else {\n        this.hud.show()\n      }\n    } else {\n      this.create($target, settings)\n      // `this.create()` creates the form\n      this.form?.focus()\n    }\n\n    this.trigger('show')\n  }\n\n  public hide (): void {\n    this.hud?.hide()\n    this.trigger('hide')\n  }\n\n  public hideFooter (): void {\n    this.hud?.$hud.removeClass('show-footer')\n  }\n\n  public showFooter (): void {\n    this.hud?.$hud.addClass('show-footer')\n  }\n\n  public setSaving (enabled = true): void {\n    this.$save.toggleClass('disabled', enabled)\n    this.$spinner.toggleClass('hidden', !enabled)\n  }\n}\n","import * as $ from 'jquery'\nimport Emitter from './Emitter'\nimport { uniqueId } from './utilities'\n\ninterface RequestParameters {\n  assetId?: string\n  callback?: string\n  showContent: 0 | 1\n  url?: string\n}\n\ninterface RequestSettings {\n  assetId?: string\n  callback?: string\n  showContent?: boolean\n  url?: string\n}\n\nexport default class Preview extends Emitter {\n  public $element: JQuery | null\n  public $iframe: JQuery<HTMLIFrameElement>\n  private _$warningTrigger?: JQuery | null\n  private _height: number\n  private _heightMonitor: number\n  private _requestTimeout: NodeJS.Timeout\n  private _warningHud?: GarnishHUD | null\n\n  constructor () {\n    super()\n\n    if (typeof window.EmbeddedAssetsPreviewMap === 'undefined') {\n      window.EmbeddedAssetsPreviewMap = new Map()\n    }\n\n    const iframeId = uniqueId()\n\n    this.$element = $(`\n      <div class=\"embedded-assets_preview\">\n        <iframe id=\"${iframeId}\" src=\"about:blank\"></iframe>\n      </div>\n    `)\n\n    this.$iframe = this.$element.find(`#${iframeId}`) as JQuery<HTMLIFrameElement>\n\n    this._setupHeightMonitor()\n  }\n\n  public destroy (): void {\n    this.$element?.remove()\n    this.$element = null\n\n    if (typeof this._$warningTrigger !== 'undefined' && this._$warningTrigger !== null) {\n      this._$warningTrigger.remove()\n      this._$warningTrigger = null\n    }\n\n    if (typeof this._warningHud !== 'undefined' && this._warningHud !== null) {\n      this._warningHud.hide()\n      this._warningHud.$hud.remove()\n      this._warningHud.$shade.remove()\n      this._warningHud = null\n    }\n\n    window.cancelAnimationFrame(this._heightMonitor)\n    clearTimeout(this._requestTimeout)\n\n    this.trigger('destroy')\n  }\n\n  public getWindow (): Window | null {\n    return this.$iframe[0].contentWindow\n  }\n\n  public getDocument (): Document | null {\n    return this.getWindow()?.document ?? null\n  }\n\n  public getBody (): HTMLElement | null {\n    return this.getDocument()?.body ?? null\n  }\n\n  public showWarning (): void {\n    const $previewWindow = $(this.getWindow() as Window)\n    const $previewDocument = $(this.getDocument() as Document)\n    const $warning = $previewDocument.find('#warning')\n\n    if ($warning.length > 0) {\n      const { top: frameTop, left: frameLeft } = this.$iframe.offset() as JQueryCoordinates\n      const frameScroll = $previewWindow.scrollTop() as number\n\n      const { top: iconTop, left: iconLeft } = $warning.offset() as JQueryCoordinates\n\n      const top = frameTop - frameScroll + iconTop\n      const left = frameLeft + iconLeft\n      const width = $warning.outerWidth() as number\n      const height = $warning.outerHeight() as number\n\n      if (typeof this._$warningTrigger === 'undefined' || this._$warningTrigger === null) {\n        this._$warningTrigger = $('<div>').css({\n          position: 'absolute',\n          display: 'none'\n        })\n\n        Garnish.$bod.append(this._$warningTrigger)\n      }\n\n      this._$warningTrigger.css({\n        display: 'block',\n        top: `${top}px`,\n        left: `${left}px`,\n        width: `${width}px`,\n        height: `${height}px`\n      })\n\n      if (typeof this._warningHud === 'undefined' || this._warningHud === null) {\n        const untrustedSource = Craft.t('embeddedassets', 'This information is coming from an untrusted source.')\n        const securityMeasure = window.EmbeddedAssets.preventNonWhitelistedUploads\n          ? Craft.t('embeddedassets', 'This embedded asset cannot be saved.')\n          : Craft.t('embeddedassets', 'As a security measure embed codes will not be shown.')\n        const $message = $(`\n          <p><strong>${untrustedSource}</strong></p>\n          <p>${securityMeasure}</p>\n        `)\n\n        this._warningHud = new Garnish.HUD(this._$warningTrigger, $message, {\n          hudClass: 'hud info-hud',\n          closeOtherHUDs: false,\n          onHide: () => this._$warningTrigger?.css('display', 'none')\n        })\n      } else {\n        this._warningHud.show()\n      }\n    }\n  }\n\n  public request (settings?: RequestSettings, timeout: number = 15000): void {\n    const reqSettings = Object.assign({\n      showContent: true,\n      callback: uniqueId('embeddedassets')\n    }, settings ?? {}) as RequestSettings\n\n    const previewWindow = this.getWindow()\n\n    if (previewWindow !== null) {\n      clearTimeout(this._requestTimeout)\n\n      const showPreview = Boolean(reqSettings.url ?? reqSettings.assetId)\n      let previewUrl = 'about:blank'\n\n      if (showPreview) {\n        const complete: (trigger: string) => void = (trigger) => {\n          clearTimeout(this._requestTimeout)\n\n          if (window.EmbeddedAssetsPreviewMap?.has(reqSettings.callback as string) ?? false) {\n            window.EmbeddedAssetsPreviewMap?.delete(reqSettings.callback as string)\n          }\n\n          this.trigger(trigger, parameters)\n        }\n\n        const preventNonWhitelistedUploads = window.EmbeddedAssets.preventNonWhitelistedUploads\n        window.EmbeddedAssetsPreviewMap?.set(\n          reqSettings.callback as string,\n          () => complete(this._setupWarning() && preventNonWhitelistedUploads ? 'blacklisted' : 'load')\n        )\n\n        this._requestTimeout = setTimeout(() => complete('timeout'), timeout)\n\n        const parameters: RequestParameters = {\n          showContent: (reqSettings.showContent ?? true) ? 1 : 0,\n          callback: reqSettings.callback\n        }\n\n        if (typeof reqSettings.url !== 'undefined') {\n          parameters.url = reqSettings.url\n        } else if (typeof reqSettings.assetId !== 'undefined') {\n          parameters.assetId = reqSettings.assetId\n        }\n\n        previewUrl = Craft.getActionUrl('embeddedassets/actions/preview', {\n          ...parameters,\n          url: parameters?.url ?? null\n        })\n      }\n\n      previewWindow.location.replace(previewUrl)\n    }\n  }\n\n  private _setupHeightMonitor (): void {\n    this._height = 0\n\n    const monitorHeight: () => void = () => {\n      const $previewBody = $(this.getBody() ?? $())\n      const height = $previewBody.height() ?? 0\n\n      if (this._height !== height) {\n        this.trigger('resize', { prevHeight: this._height, height })\n        this._height = height\n      }\n\n      this._heightMonitor = window.requestAnimationFrame(monitorHeight)\n    }\n\n    monitorHeight()\n  }\n\n  private _setupWarning (): boolean {\n    const $previewDocument = $(this.getDocument() ?? $())\n    const $warning = $previewDocument.find('#warning')\n    const hasWarning = $warning.length > 0\n\n    if (hasWarning) {\n      // Just in case\n      $warning.off('.embeddedassets')\n      $warning.on('click.embeddedassets', () => this.showWarning())\n    }\n\n    return hasWarning\n  }\n}\n","export function monkeypatch (Class: any, method: string, callback: Function): void {\n  const methodFn = Class.prototype[method]\n\n  Class.prototype[method] = function () {\n    methodFn.apply(this, arguments)\n    callback.call(this)\n  }\n}\n\nlet uidCounter = 0\nexport function uniqueId (prefix: string = 'uid'): string {\n  return `${prefix}${Math.random().toString(36).substr(2)}${uidCounter++}`\n}\n\nexport function isUrl (url: string): boolean {\n  return /^https?:\\/\\//.test(url)\n}\n","module.exports = jQuery;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import '../styles/main.scss'\nimport * as $ from 'jquery'\nimport EmbeddedAssets from './EmbeddedAssets'\nimport Button from './Button'\nimport { monkeypatch } from './utilities'\n\ndeclare global {\n  interface Window {\n    EmbeddedAssets: EmbeddedAssets\n    EmbeddedAssetsPreviewMap?: Map<string, FrameRequestCallback>\n  }\n}\n\nconst embeddedAssets = new EmbeddedAssets()\n\nmonkeypatch(Craft.AssetIndex, 'init', function () {\n  const button = new Button('Embed')\n  const replaceButton = new Button('Replace')\n\n  const $uploadButton = this.$uploadButton\n\n  // If there's no upload button, there should be no embed button\n  if (typeof $uploadButton === 'undefined' || $uploadButton === null) {\n    return\n  }\n\n  const inHeader = $uploadButton.closest('#header').length > 0\n  const inModal = $uploadButton.closest('.modal').length > 0\n\n  // Empty array just means no file type restrictions\n  const allowedAssetKinds = this.settings.criteria?.kind ?? []\n\n  let modalOrientations\n\n  if (inHeader) {\n    this.$uploadButton.before(button.$element)\n    this.$uploadButton.before(replaceButton.$element)\n    modalOrientations = ['bottom', 'left', 'right', 'top']\n  } else if (inModal) {\n    this.$uploadButton.after(button.$element)\n    this.$uploadButton.after(replaceButton.$element)\n    modalOrientations = ['top', 'right', 'bottom', 'left']\n  }\n\n  const showButtonIfJsonAllowed: (button: Button, allowedKinds: string | string[]) => void = (button, allowedKinds = []) => {\n    if (typeof allowedKinds === 'string') {\n      allowedKinds = [allowedKinds]\n    }\n\n    // We still need to check the array length, because `allowedKinds` will be an empty array if the\n    // asset field had no restriction on allowed file types\n    if (allowedKinds.length > 0 && !allowedKinds.includes('json')) {\n      button.hide()\n    } else {\n      button.show()\n    }\n  }\n\n  showButtonIfJsonAllowed(button, allowedAssetKinds)\n  replaceButton.hide()\n\n  const getActionTarget: () => Object = () => {\n    if (this.sourcePath?.length > 0 ?? false) {\n      // Craft 4.4 subfolder compatibility\n      const currentFolder = this.sourcePath[this.sourcePath.length - 1]\n\n      if (typeof currentFolder.folderId !== 'undefined') {\n        return {\n          targetType: 'folder',\n          targetId: currentFolder.folderId\n        }\n      }\n    }\n\n    const split = this.sourceKey.split(':')\n\n    if (typeof split[split.length - 2] !== 'undefined') {\n      return {\n        targetType: split[split.length - 2],\n        targetUid: split[split.length - 1]\n      }\n    }\n\n    return {}\n  }\n\n  embeddedAssets.addButton(button, modalOrientations, getActionTarget)\n  embeddedAssets.addButton(replaceButton, modalOrientations, getActionTarget, true)\n\n  let idsToSelect: string[] = []\n\n  embeddedAssets.on('save', (e: any) => {\n    idsToSelect.push(e.assetId)\n    this.updateElements()\n  })\n\n  this.on('updateElements', () => {\n    idsToSelect.forEach((id) => this.view.selectElementById(id))\n    idsToSelect = []\n\n    showButtonIfJsonAllowed(button, allowedAssetKinds)\n    replaceButton.hide()\n  })\n\n  this.on('selectionChange', (e: any) => {\n    const selectedItems = e.target.view?.elementSelect.$selectedItems ?? []\n\n    if (selectedItems.length === 1) {\n      const findAssetEl = $(selectedItems[0]).find('[data-embedded-asset]')\n\n      if (findAssetEl.length > 0) {\n        button.hide()\n        replaceButton.show()\n\n        embeddedAssets.setReplaceAssetId(selectedItems[0].attributes['data-id'].value)\n      } else {\n        showButtonIfJsonAllowed(button, allowedAssetKinds)\n        replaceButton.hide()\n      }\n    } else {\n      showButtonIfJsonAllowed(button, allowedAssetKinds)\n      replaceButton.hide()\n    }\n  })\n})\n\nwindow.EmbeddedAssets = embeddedAssets\n"],"names":["constructor","label","this","$element","$","setLabel","destroy","remove","text","Craft","t","show","hide","setActive","flag","toggleClass","EmbeddedAssets","super","_currentGetActionTarget","modal","_getActionTarget","buttons","on","forEach","b","e","trigger","preventNonWhitelistedUploads","_preventNonWhitelistedUploads","prevent","setReplaceAssetId","id","_replaceAssetId","addButton","button","orientations","getActionTarget","replace","push","form","setReplace","removeButton","filter","_events","Map","type","callback","has","set","get","off","size","newList","fn","length","delete","event","Object","assign","call","Form","_state","_url","inputId","uniqueId","bodyId","formAction","getActionUrl","$input","find","$body","preview","prepend","url","setState","cp","displayError","css","height","preventDefault","isSameUrl","val","request","save","clipboardData","originalEvent","getData","_setupHeightMonitor","window","cancelAnimationFrame","_heightMonitor","isUrl","focus","select","clear","_replace","actionTarget","data","assetId","queue","Promise","resolve","reject","sendActionRequest","then","response","success","payload","undefined","error","Error","catch","state","attr","_height","monitorHeight","prevHeight","requestAnimationFrame","Modal","hud","create","$target","settings","hudClass","mainClass","minBodyWidth","cancelId","saveId","spinnerId","cancelLabel","saveLabel","$footer","$cancel","$save","$spinner","Garnish","HUD","add","hasClass","stopImmediatePropagation","hideFooter","showFooter","setSaving","updateSizeAndPosition","$hud","$shade","_monitor","setSettings","$trigger","showing","queueUpdateSizeAndPosition","removeClass","addClass","enabled","Preview","EmbeddedAssetsPreviewMap","iframeId","$iframe","_$warningTrigger","_warningHud","clearTimeout","_requestTimeout","getWindow","contentWindow","getDocument","document","getBody","body","showWarning","$previewWindow","$warning","top","frameTop","left","frameLeft","offset","frameScroll","scrollTop","iconTop","iconLeft","width","outerWidth","outerHeight","position","display","$bod","append","untrustedSource","securityMeasure","$message","closeOtherHUDs","onHide","timeout","reqSettings","showContent","previewWindow","previewUrl","Boolean","complete","parameters","_setupWarning","setTimeout","location","hasWarning","Class","method","methodFn","prototype","apply","arguments","uidCounter","prefix","Math","random","toString","substr","test","module","exports","jQuery","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","r","Symbol","toStringTag","defineProperty","value","embeddedAssets","monkeypatch","AssetIndex","replaceButton","$uploadButton","inHeader","closest","inModal","allowedAssetKinds","criteria","kind","modalOrientations","before","after","showButtonIfJsonAllowed","allowedKinds","includes","sourcePath","currentFolder","folderId","targetType","targetId","split","sourceKey","targetUid","idsToSelect","updateElements","view","selectElementById","selectedItems","target","elementSelect","$selectedItems","attributes"],"sourceRoot":""}